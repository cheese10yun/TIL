> [몽고 디비 완벽 가이드](http://www.yes24.com/Product/Goods/97980005)

# 1 몽고DB 소개

* 몽고DB는 도큐먼트 지향 데이터베이스다. 관계형 모델을 사용하지 않던 주된 이유는 분산 확장을 쉽게 하기 위함 이지만 다른 이점도 있다.
* 도큐먼트 지향 데이터베이스에서는 행 겨념 대신에 보다 유연한 모델인 도뮤컨트를 사용한다.
* 몽고DB에서는 도큐먼트의 키와 값을 미리 정의하지 않는다. 따라서 고정된 스키마가 없다.

## 확장 가능한 설계

몽고DB는 분산 확장을 염두에 두고 설계 됐다. 도큐먼트 지향 데이터 모델은 데이터를 여러 서버에 더 쉽게 분산하게 해준다. 도큐먼트를 자동으로 재분배하고 사용자 요청을 올바른 장비에 라우팅함으로써 클러스터 내 데이터 양과 부하를 조절할 수 있다.

몽고DB 클러스터의 토폴리지나 데이터베이스 연결의 다른 쪽 끝에 단일 노드가 아닌 클러스터가 있는지 애플리케이션에서 분명히 알 수 있다. 더 큰 부하를 지원하도록 기존에 배포된 애플리케이션의 토폴로지를 변경할 떄도 마찬가지로 애플리케이션 로직은 그대로 유지할 수 있다.

## 다양한 기능

### 인덱싱

몽고DB는 일반적인 보조 인덱스를 지원하며, 고유, 복합, 공간 정보, 전문 인덱싱 기능도 제공한다. 중첩된 도뮤컨트 및 배열과 같은 계층 구조의 보조 인ㄴ덱스도 지원하며, 개발자는 모델링 기능을 자신의 애플리케이션에 가장 적합한 방식으로 최대한 활용할 수 있다.

### 집계

몽고DB는 데이터 처리 파이프라인 개념을 기반으로 한 집계 프레임워크를 제공한다. 집계 파이프라인은 데이터베이스 최적화를 최대한 활용해, 서버 측에서 비교적 간단한 일련의 단예로 데이터를 처리함으로써 복잡한 분석 엔진을 구축하게 해준다.

### 특수한 컬렉션 유형

몽고DB는 로그와 같은 최신ㄴ 데이터를 유지하고자 세션이나 고정 크기 컬력센과 같이 특정 시간에 만려해야 하는 데이터에 대한 유효 시간 TTL 컬렉션을 지원한다. 또한 기준 필터와 일치하는 도큐먼트에 한정된 부분 인덱스를 지원함으로써 효율성을 높이고 필요한 젖아 공간을 줄인다.

### 파일 스토리지

몽고DB는 큰 파일에 파일 메타데이터를 편리하게 저장하는 프로토컬을 지원한다.

관계형 데이터베이스에 공통적으로 사용되는 일부 기능, 특히 복잡한 조인은 몽고DB에 존재하지 않는다. 몽고DB 3.2에 도입단 $lookup 집계 연산자를 사요함으로써 매우 제한된 방식으로 조인하도록 지원한다.

## 고성능

몽고DB에서는 동시성과 처리량을 극대화하기 위해 와이어드타이거 스토리지 엔진에 기회적 락을 사용했다. 따라서 캐시처럼 제한도ㅓㅣㄴ 용량의 램으로 쿼리에 알맞는 인덱스를 자동으로 선택할 수 있다.

몽고DB는 강력한 성능을 제공하면서 관계형 시스템의 많은 기능을 포함한다. 일부 기능의 경우 데이터베이스 서버는 처리와 로직을 클라이언트 측에 오프로드한다.(드라이버 또는 사용자의 애플리케이션 코드에의해 처리된다.)

와이어드타이거??

# 몽고DB 기본

## 도큐먼트

* 도큐먼트의 키는 문자열이다. 몇 가지를 제외하면 어떤 UTF-8 문자든 쓸 수 있다.
* 몽고DB는 데이터형과 대소문자를 구분한다. 
  * { "count": 5 }, { "count": "5" } 서로 다르다 

## 컬렉션
컬렉션은 도큐먼트의 모움이다. 몽고DB의 도큐먼트가 관계형 데이터베이스의 행에 대응된다면 컬렉션은 테이블에 애응된다고 볼 수 있다.


### 동적 스키마
컬렉션은 동적 스키마를 가진다. 하나의 컬렉션 내 도큐먼트들이 모두 다른 구조를 가질 수 있다는 의미이다. 예를 들어 다음 도큐먼트들을 하나으; 컬렉션에 저장할 수 있다.

```micronaut-mongodb-json
{
  "greeting": "Hello, world!",
  "views": 3
}
{
  "signoff": "Good night, and good luck"
}
```





# 5 인덱싱

* 인덱싱의 정의와 사용 이유
* 인덱싱할 필드를 선정하는 방법
* 인덱스 사용을 평가하고 적용하는 방법
* 인덱스 생성 및 제거에 대한 관리 정보

## 인덱싱 소개

인덱스를 사용하지 않는 쿼리를 컬렉션 스캔이라 하며, 서버가 쿼리 결과를 찾으려면 전체 내용을 살펴봐야 함을 의미한다.

```
db.users.find({"username": "user101"}).explain("executionStats")
```

executionStats 모드는 인덱스를 이용한 쿼리의 효과를 이해하는데 도움이 된다.

* mysql 인